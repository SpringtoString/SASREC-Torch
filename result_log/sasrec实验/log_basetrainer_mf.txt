train on cuda:2
Train on 987531 samples,  965 steps per epoch
epoch 1 60.07s train loss is [0.5566 = 0.5199 + 0.0367] 
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |        time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|   1   | 0.4116215705871582 | [0.00450332 0.00433776] | [0.02251656 0.04337749] | [0.01343716 0.02005526] | [0.02251656 0.04337749] | [0.01048841 0.01314477] |
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 2 59.85s train loss is [0.4429 = 0.3620 + 0.0808] 
epoch 3 61.48s train loss is [0.4362 = 0.3504 + 0.0858] 
epoch 4 62.25s train loss is [0.4338 = 0.3461 + 0.0877] 
epoch 5 60.49s train loss is [0.4323 = 0.3430 + 0.0892] 
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |        time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|   5   | 0.1278388500213623 | [0.00476822 0.00427153] | [0.02384106 0.04271523] | [0.01509271 0.0211013 ] | [0.02384106 0.04271523] | [0.01223234 0.01465482] |
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 6 59.85s train loss is [0.4291 = 0.3380 + 0.0910] 
epoch 7 59.58s train loss is [0.4275 = 0.3345 + 0.0931] 
epoch 8 59.45s train loss is [0.4252 = 0.3300 + 0.0953] 
epoch 9 60.11s train loss is [0.4225 = 0.3247 + 0.0978] 
epoch 10 60.13s train loss is [0.4203 = 0.3199 + 0.1004] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|   10  | 0.11889863014221191 | [0.0057616  0.00491723] | [0.02880795 0.04917219] | [0.01812256 0.02463821] | [0.02880795 0.04917219] | [0.01464404 0.01729239] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 11 59.37s train loss is [0.4178 = 0.3145 + 0.1033] 
epoch 12 59.70s train loss is [0.4143 = 0.3079 + 0.1064] 
epoch 13 59.56s train loss is [0.4128 = 0.3035 + 0.1092] 
epoch 14 59.55s train loss is [0.4100 = 0.2976 + 0.1123] 
epoch 15 59.81s train loss is [0.4085 = 0.2935 + 0.1150] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|   15  | 0.09996843338012695 | [0.00586094 0.00509935] | [0.02930464 0.05099338] | [0.01864114 0.02565114] | [0.02930464 0.05099338] | [0.01513245 0.0180235 ] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 16 60.12s train loss is [0.4064 = 0.2887 + 0.1177] 
epoch 17 59.79s train loss is [0.4068 = 0.2871 + 0.1196] 
epoch 18 57.51s train loss is [0.4052 = 0.2836 + 0.1215] 
epoch 19 59.25s train loss is [0.4046 = 0.2814 + 0.1231] 
epoch 20 59.58s train loss is [0.4041 = 0.2794 + 0.1247] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|   20  | 0.10409355163574219 | [0.00599339 0.00551326] | [0.02996689 0.05513245] | [0.0192469  0.02732607] | [0.02996689 0.05513245] | [0.01574503 0.01904571] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 21 59.49s train loss is [0.4027 = 0.2766 + 0.1261] 
epoch 22 58.89s train loss is [0.4022 = 0.2748 + 0.1274] 
epoch 23 54.36s train loss is [0.4017 = 0.2731 + 0.1286] 
epoch 24 52.96s train loss is [0.4015 = 0.2718 + 0.1298] 
epoch 25 53.28s train loss is [0.4010 = 0.2701 + 0.1309] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|   25  | 0.11471056938171387 | [0.0062914  0.00579471] | [0.03145695 0.05794702] | [0.01975084 0.02824247] | [0.03145695 0.05794702] | [0.0159437  0.01940509] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 26 53.65s train loss is [0.4012 = 0.2693 + 0.1319] 
epoch 27 53.39s train loss is [0.4000 = 0.2672 + 0.1329] 
epoch 28 54.21s train loss is [0.3994 = 0.2656 + 0.1338] 
epoch 29 52.33s train loss is [0.3992 = 0.2644 + 0.1347] 
epoch 30 54.03s train loss is [0.3992 = 0.2638 + 0.1354] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|   30  | 0.11434078216552734 | [0.00665564 0.00581126] | [0.03327814 0.05811258] | [0.02015993 0.02806371] | [0.03327814 0.05811258] | [0.01589404 0.01908021] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 31 53.31s train loss is [0.3990 = 0.2628 + 0.1362] 
epoch 32 53.04s train loss is [0.3985 = 0.2615 + 0.1370] 
epoch 33 54.32s train loss is [0.3988 = 0.2613 + 0.1375] 
epoch 34 52.57s train loss is [0.3980 = 0.2598 + 0.1382] 
epoch 35 54.30s train loss is [0.3981 = 0.2592 + 0.1389] 
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |        time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|   35  | 0.1119377613067627 | [0.00672187 0.00561259] | [0.03360927 0.05612583] | [0.02109967 0.02833811] | [0.03360927 0.05612583] | [0.01701711 0.01997793] |
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 36 53.36s train loss is [0.3973 = 0.2579 + 0.1394] 
epoch 37 53.29s train loss is [0.3982 = 0.2583 + 0.1399] 
epoch 38 52.76s train loss is [0.3973 = 0.2570 + 0.1404] 
epoch 39 54.17s train loss is [0.3972 = 0.2563 + 0.1409] 
epoch 40 53.14s train loss is [0.3970 = 0.2557 + 0.1413] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|   40  | 0.09504342079162598 | [0.00639074 0.00586093] | [0.03195364 0.05860927] | [0.02008262 0.02860509] | [0.03195364 0.05860927] | [0.01621689 0.01967821] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 41 53.37s train loss is [0.3974 = 0.2557 + 0.1416] 
epoch 42 54.31s train loss is [0.3977 = 0.2560 + 0.1417] 
epoch 43 53.70s train loss is [0.3965 = 0.2544 + 0.1421] 
epoch 44 53.80s train loss is [0.3971 = 0.2547 + 0.1424] 
epoch 45 53.18s train loss is [0.3973 = 0.2545 + 0.1428] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|   45  | 0.09615039825439453 | [0.00711922 0.00622517] | [0.03559603 0.06225166] | [0.02229236 0.03081021] | [0.03559603 0.06225166] | [0.01795805 0.02141359] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 46 53.94s train loss is [0.3970 = 0.2540 + 0.1430] 
epoch 47 53.53s train loss is [0.3970 = 0.2536 + 0.1433] 
epoch 48 54.02s train loss is [0.3969 = 0.2535 + 0.1434] 
epoch 49 53.75s train loss is [0.3970 = 0.2534 + 0.1436] 
epoch 50 52.95s train loss is [0.3970 = 0.2533 + 0.1437] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|   50  | 0.11584138870239258 | [0.00682121 0.00620861] | [0.03410596 0.06208609] | [0.02124796 0.03023631] | [0.03410596 0.06208609] | [0.01706677 0.02074024] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 51 52.85s train loss is [0.3968 = 0.2528 + 0.1440] 
epoch 52 53.65s train loss is [0.3973 = 0.2532 + 0.1441] 
epoch 53 53.80s train loss is [0.3975 = 0.2533 + 0.1442] 
epoch 54 53.65s train loss is [0.3969 = 0.2526 + 0.1443] 
epoch 55 53.78s train loss is [0.3968 = 0.2523 + 0.1444] 
+-------+---------------------+-------------------------+-------------------------+-----------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |          ndcg         |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-----------------------+-------------------------+-------------------------+
|   55  | 0.09724617004394531 | [0.00698677 0.00620861] | [0.03493378 0.06208609] | [0.0216382 0.0303777] | [0.03493378 0.06208609] | [0.01733996 0.02092315] |
+-------+---------------------+-------------------------+-------------------------+-----------------------+-------------------------+-------------------------+
 
epoch 56 53.68s train loss is [0.3966 = 0.2520 + 0.1445] 
epoch 57 53.28s train loss is [0.3967 = 0.2520 + 0.1446] 
epoch 58 55.43s train loss is [0.3971 = 0.2524 + 0.1447] 
epoch 59 53.29s train loss is [0.3966 = 0.2518 + 0.1448] 
epoch 60 53.35s train loss is [0.3967 = 0.2517 + 0.1450] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|   60  | 0.12286615371704102 | [0.00695366 0.0063245 ] | [0.03476821 0.06324504] | [0.0214465  0.03054607] | [0.03476821 0.06324504] | [0.01711644 0.02080994] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 61 54.33s train loss is [0.3967 = 0.2517 + 0.1449] 
epoch 62 53.81s train loss is [0.3965 = 0.2515 + 0.1451] 
epoch 63 53.94s train loss is [0.3973 = 0.2522 + 0.1451] 
epoch 64 53.45s train loss is [0.3967 = 0.2517 + 0.1450] 
epoch 65 54.54s train loss is [0.3967 = 0.2514 + 0.1452] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|   65  | 0.11572384834289551 | [0.00721856 0.00614239] | [0.03609271 0.06142384] | [0.02233629 0.03046366] | [0.03609271 0.06142384] | [0.01786976 0.02118687] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 66 53.21s train loss is [0.3970 = 0.2518 + 0.1452] 
epoch 67 52.62s train loss is [0.3964 = 0.2510 + 0.1454] 
epoch 68 53.22s train loss is [0.3968 = 0.2514 + 0.1454] 
epoch 69 53.71s train loss is [0.3966 = 0.2512 + 0.1455] 
epoch 70 53.06s train loss is [0.3966 = 0.2511 + 0.1455] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|   70  | 0.08775877952575684 | [0.00695366 0.00630795] | [0.03476821 0.06307947] | [0.02165747 0.03065244] | [0.03476821 0.06307947] | [0.01737858 0.0209987 ] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 71 53.02s train loss is [0.3968 = 0.2512 + 0.1456] 
epoch 72 54.14s train loss is [0.3962 = 0.2504 + 0.1457] 
epoch 73 52.88s train loss is [0.3973 = 0.2517 + 0.1456] 
epoch 74 54.11s train loss is [0.3969 = 0.2512 + 0.1457] 
epoch 75 53.08s train loss is [0.3962 = 0.2504 + 0.1458] 
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |        time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|   75  | 0.0937347412109375 | [0.00685432 0.00635761] | [0.03427152 0.06357616] | [0.02117127 0.03049376] | [0.03427152 0.06357616] | [0.01690121 0.0206589 ] |
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 76 53.18s train loss is [0.3964 = 0.2506 + 0.1458] 
epoch 77 53.91s train loss is [0.3965 = 0.2507 + 0.1458] 
epoch 78 53.53s train loss is [0.3964 = 0.2506 + 0.1458] 
epoch 79 53.74s train loss is [0.3968 = 0.2510 + 0.1458] 
epoch 80 53.81s train loss is [0.3969 = 0.2511 + 0.1458] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|   80  | 0.12362384796142578 | [0.00672187 0.00635761] | [0.03360927 0.06357616] | [0.02051922 0.03012904] | [0.03360927 0.06357616] | [0.01625276 0.02017168] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 81 54.05s train loss is [0.3967 = 0.2507 + 0.1459] 
epoch 82 54.02s train loss is [0.3967 = 0.2508 + 0.1459] 
epoch 83 53.74s train loss is [0.3967 = 0.2508 + 0.1460] 
epoch 84 54.26s train loss is [0.3964 = 0.2504 + 0.1460] 
epoch 85 53.53s train loss is [0.3963 = 0.2502 + 0.1461] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|   85  | 0.12275195121765137 | [0.00685432 0.00625828] | [0.03427152 0.06258278] | [0.02140656 0.03040284] | [0.03427152 0.06258278] | [0.01721302 0.02083255] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 86 53.88s train loss is [0.3966 = 0.2504 + 0.1462] 
epoch 87 53.30s train loss is [0.3969 = 0.2508 + 0.1461] 
epoch 88 53.35s train loss is [0.3968 = 0.2507 + 0.1461] 
epoch 89 53.67s train loss is [0.3962 = 0.2500 + 0.1462] 
epoch 90 53.24s train loss is [0.3966 = 0.2503 + 0.1462] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|   90  | 0.10608434677124023 | [0.007053   0.00596027] | [0.0352649  0.05960265] | [0.02170011 0.02948344] | [0.0352649  0.05960265] | [0.01729029 0.0204509 ] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 91 54.31s train loss is [0.3964 = 0.2501 + 0.1463] 
epoch 92 53.10s train loss is [0.3965 = 0.2502 + 0.1463] 
epoch 93 53.11s train loss is [0.3968 = 0.2505 + 0.1464] 
epoch 94 54.27s train loss is [0.3966 = 0.2502 + 0.1464] 
epoch 95 54.00s train loss is [0.3962 = 0.2497 + 0.1465] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|   95  | 0.11333847045898438 | [0.00678809 0.00620861] | [0.0339404  0.06208609] | [0.02084505 0.02997999] | [0.0339404  0.06208609] | [0.01656457 0.02035413] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 96 53.74s train loss is [0.3962 = 0.2498 + 0.1464] 
epoch 97 53.30s train loss is [0.3966 = 0.2501 + 0.1464] 
epoch 98 54.54s train loss is [0.3962 = 0.2496 + 0.1466] 
epoch 99 54.28s train loss is [0.3967 = 0.2500 + 0.1467] 
epoch 100 53.30s train loss is [0.3970 = 0.2504 + 0.1466] 
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |        time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  100  | 0.0957498550415039 | [0.00682121 0.00645695] | [0.03410596 0.06456953] | [0.02098165 0.03068197] | [0.03410596 0.06456953] | [0.01670254 0.02061752] |
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 101 54.75s train loss is [0.3965 = 0.2498 + 0.1466] 
epoch 102 53.05s train loss is [0.3961 = 0.2494 + 0.1467] 
epoch 103 54.28s train loss is [0.3968 = 0.2501 + 0.1468] 
epoch 104 53.99s train loss is [0.3964 = 0.2496 + 0.1468] 
epoch 105 54.08s train loss is [0.3967 = 0.2499 + 0.1468] 
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |        time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  105  | 0.0975792407989502 | [0.00701988 0.00647351] | [0.03509934 0.0647351 ] | [0.0214146  0.03084795] | [0.03509934 0.0647351 ] | [0.01695364 0.02075876] |
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 106 53.80s train loss is [0.3964 = 0.2495 + 0.1469] 
epoch 107 53.95s train loss is [0.3965 = 0.2496 + 0.1469] 
epoch 108 53.07s train loss is [0.3962 = 0.2493 + 0.1469] 
epoch 109 53.86s train loss is [0.3957 = 0.2486 + 0.1471] 
epoch 110 54.28s train loss is [0.3962 = 0.2491 + 0.1471] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  110  | 0.08801722526550293 | [0.00715233 0.00627483] | [0.03576159 0.06274834] | [0.02197605 0.03050815] | [0.03576159 0.06274834] | [0.01748344 0.02088984] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 111 52.79s train loss is [0.3963 = 0.2492 + 0.1471] 
epoch 112 51.74s train loss is [0.3965 = 0.2495 + 0.1470] 
epoch 113 53.25s train loss is [0.3972 = 0.2503 + 0.1470] 
epoch 114 53.10s train loss is [0.3961 = 0.2491 + 0.1470] 
epoch 115 54.25s train loss is [0.3960 = 0.2488 + 0.1472] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  115  | 0.10224246978759766 | [0.00715233 0.00657284] | [0.03576159 0.06572848] | [0.02220673 0.03180837] | [0.03576159 0.06572848] | [0.01778422 0.02169748] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 116 53.14s train loss is [0.3964 = 0.2492 + 0.1472] 
epoch 117 53.39s train loss is [0.3962 = 0.2489 + 0.1473] 
epoch 118 53.42s train loss is [0.3962 = 0.2489 + 0.1473] 
epoch 119 53.41s train loss is [0.3965 = 0.2493 + 0.1472] 
epoch 120 53.43s train loss is [0.3967 = 0.2495 + 0.1472] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  120  | 0.10603618621826172 | [0.007053   0.00640728] | [0.0352649  0.06407285] | [0.02184078 0.03111114] | [0.0352649  0.06407285] | [0.01743929 0.02123903] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 121 54.18s train loss is [0.3962 = 0.2488 + 0.1474] 
epoch 122 53.62s train loss is [0.3962 = 0.2487 + 0.1474] 
epoch 123 54.71s train loss is [0.3966 = 0.2491 + 0.1474] 
epoch 124 53.85s train loss is [0.3962 = 0.2487 + 0.1475] 
epoch 125 54.62s train loss is [0.3962 = 0.2487 + 0.1475] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  125  | 0.11032652854919434 | [0.00698677 0.00615894] | [0.03493378 0.0615894 ] | [0.02156487 0.03014024] | [0.03493378 0.0615894 ] | [0.01722958 0.02074149] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 126 52.59s train loss is [0.3964 = 0.2489 + 0.1474] 
epoch 127 53.80s train loss is [0.3965 = 0.2491 + 0.1474] 
epoch 128 53.86s train loss is [0.3963 = 0.2489 + 0.1474] 
epoch 129 53.80s train loss is [0.3964 = 0.2489 + 0.1475] 
epoch 130 53.79s train loss is [0.3967 = 0.2493 + 0.1474] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  130  | 0.10001659393310547 | [0.00698677 0.00639073] | [0.03493378 0.06390729] | [0.02116301 0.030361  ] | [0.03493378 0.06390729] | [0.01668873 0.02038611] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 131 54.44s train loss is [0.3960 = 0.2485 + 0.1475] 
epoch 132 54.00s train loss is [0.3962 = 0.2486 + 0.1475] 
epoch 133 53.84s train loss is [0.3965 = 0.2489 + 0.1475] 
epoch 134 54.20s train loss is [0.3958 = 0.2483 + 0.1476] 
epoch 135 53.89s train loss is [0.3964 = 0.2488 + 0.1477] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  135  | 0.10059642791748047 | [0.0073179  0.00630795] | [0.0365894  0.06307947] | [0.02227981 0.03077952] | [0.0365894  0.06307947] | [0.01762141 0.02109036] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 136 54.09s train loss is [0.3958 = 0.2481 + 0.1477] 
epoch 137 54.90s train loss is [0.3963 = 0.2486 + 0.1476] 
epoch 138 54.93s train loss is [0.3964 = 0.2488 + 0.1476] 
epoch 139 53.69s train loss is [0.3961 = 0.2486 + 0.1476] 
epoch 140 53.57s train loss is [0.3963 = 0.2487 + 0.1476] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  140  | 0.11262750625610352 | [0.00695366 0.00625828] | [0.03476821 0.06258278] | [0.02131495 0.03023767] | [0.03476821 0.06258278] | [0.0169426  0.02058558] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 141 54.14s train loss is [0.3963 = 0.2489 + 0.1475] 
epoch 142 53.05s train loss is [0.3961 = 0.2484 + 0.1477] 
epoch 143 52.92s train loss is [0.3958 = 0.2480 + 0.1478] 
epoch 144 53.80s train loss is [0.3966 = 0.2489 + 0.1477] 
epoch 145 53.06s train loss is [0.3962 = 0.2484 + 0.1477] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  145  | 0.10057806968688965 | [0.00698677 0.00629139] | [0.03493378 0.06291391] | [0.02156303 0.03048048] | [0.03493378 0.06291391] | [0.01722682 0.02082966] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 146 54.75s train loss is [0.3962 = 0.2485 + 0.1477] 
epoch 147 55.67s train loss is [0.3961 = 0.2484 + 0.1477] 
epoch 148 53.66s train loss is [0.3963 = 0.2486 + 0.1477] 
epoch 149 53.39s train loss is [0.3961 = 0.2484 + 0.1477] 
epoch 150 52.86s train loss is [0.3964 = 0.2487 + 0.1477] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  150  | 0.10233116149902344 | [0.00658942 0.00594371] | [0.03294702 0.05943708] | [0.02112798 0.02969159] | [0.03294702 0.05943708] | [0.01727097 0.02080463] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 151 53.25s train loss is [0.3959 = 0.2483 + 0.1477] 
epoch 152 53.64s train loss is [0.3964 = 0.2486 + 0.1478] 
epoch 153 53.97s train loss is [0.3968 = 0.2490 + 0.1477] 
epoch 154 53.86s train loss is [0.3960 = 0.2483 + 0.1477] 
epoch 155 54.02s train loss is [0.3965 = 0.2487 + 0.1478] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  155  | 0.10909605026245117 | [0.00701988 0.00650662] | [0.03509934 0.06506623] | [0.02185116 0.0314542 ] | [0.03509934 0.06506623] | [0.01752483 0.02143725] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 156 55.06s train loss is [0.3959 = 0.2481 + 0.1478] 
epoch 157 54.76s train loss is [0.3965 = 0.2487 + 0.1478] 
epoch 158 53.49s train loss is [0.3961 = 0.2482 + 0.1479] 
epoch 159 53.90s train loss is [0.3961 = 0.2483 + 0.1479] 
epoch 160 53.67s train loss is [0.3960 = 0.2482 + 0.1478] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  160  | 0.09766983985900879 | [0.00698677 0.00619205] | [0.03493378 0.06192053] | [0.02112938 0.02971916] | [0.03493378 0.06192053] | [0.01669149 0.02015597] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 161 53.05s train loss is [0.3963 = 0.2484 + 0.1479] 
epoch 162 53.11s train loss is [0.3961 = 0.2483 + 0.1478] 
epoch 163 54.07s train loss is [0.3963 = 0.2485 + 0.1478] 
epoch 164 53.28s train loss is [0.3960 = 0.2481 + 0.1479] 
epoch 165 54.51s train loss is [0.3963 = 0.2486 + 0.1478] 
+-------+---------------------+-------------------------+-----------------------+-------------------------+-----------------------+-------------------------+
| epoch |         time        |        precision        |         recall        |           ndcg          |       hit_ratio       |           MAP           |
+-------+---------------------+-------------------------+-----------------------+-------------------------+-----------------------+-------------------------+
|  165  | 0.11455869674682617 | [0.007053   0.00647351] | [0.0352649 0.0647351] | [0.0211438  0.03057952] | [0.0352649 0.0647351] | [0.01655353 0.02039486] |
+-------+---------------------+-------------------------+-----------------------+-------------------------+-----------------------+-------------------------+
 
epoch 166 55.48s train loss is [0.3962 = 0.2485 + 0.1476] 
epoch 167 53.73s train loss is [0.3961 = 0.2484 + 0.1477] 
epoch 168 53.89s train loss is [0.3959 = 0.2482 + 0.1477] 
epoch 169 54.75s train loss is [0.3964 = 0.2488 + 0.1476] 
epoch 170 52.64s train loss is [0.3962 = 0.2485 + 0.1477] 
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |        time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  170  | 0.1072549819946289 | [0.00708611 0.00642384] | [0.03543046 0.06423841] | [0.02179487 0.03105392] | [0.03543046 0.06423841] | [0.01732892 0.02111631] |
+-------+--------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 171 54.20s train loss is [0.3962 = 0.2485 + 0.1477] 
epoch 172 52.92s train loss is [0.3961 = 0.2484 + 0.1477] 
epoch 173 52.87s train loss is [0.3962 = 0.2485 + 0.1477] 
epoch 174 53.74s train loss is [0.3965 = 0.2488 + 0.1477] 
epoch 175 55.05s train loss is [0.3960 = 0.2482 + 0.1477] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  175  | 0.10563111305236816 | [0.00688743 0.0063245 ] | [0.03443709 0.06324504] | [0.02075362 0.03013202] | [0.03443709 0.06324504] | [0.01631347 0.02022075] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 176 54.77s train loss is [0.3962 = 0.2484 + 0.1478] 
epoch 177 53.65s train loss is [0.3959 = 0.2481 + 0.1478] 
epoch 178 54.19s train loss is [0.3969 = 0.2492 + 0.1477] 
epoch 179 53.71s train loss is [0.3963 = 0.2485 + 0.1477] 
epoch 180 53.79s train loss is [0.3965 = 0.2488 + 0.1477] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  180  | 0.12569499015808105 | [0.00701988 0.00637417] | [0.03509934 0.06374172] | [0.02130975 0.03049682] | [0.03509934 0.06374172] | [0.01685706 0.02060523] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 181 54.41s train loss is [0.3959 = 0.2481 + 0.1478] 
epoch 182 54.13s train loss is [0.3961 = 0.2483 + 0.1479] 
epoch 183 54.30s train loss is [0.3963 = 0.2485 + 0.1478] 
epoch 184 55.28s train loss is [0.3960 = 0.2480 + 0.1480] 
epoch 185 55.12s train loss is [0.3964 = 0.2485 + 0.1479] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  185  | 0.11407279968261719 | [0.00662253 0.00629139] | [0.03311258 0.06291391] | [0.01998515 0.02959112] | [0.03311258 0.06291391] | [0.01570916 0.0196537 ] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 186 53.99s train loss is [0.3966 = 0.2487 + 0.1478] 
epoch 187 54.02s train loss is [0.3963 = 0.2485 + 0.1477] 
epoch 188 53.65s train loss is [0.3966 = 0.2488 + 0.1478] 
epoch 189 54.65s train loss is [0.3957 = 0.2478 + 0.1478] 
epoch 190 54.02s train loss is [0.3962 = 0.2484 + 0.1478] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  190  | 0.09798574447631836 | [0.00715233 0.00649006] | [0.03576159 0.06490066] | [0.02217209 0.03146291] | [0.03576159 0.06490066] | [0.01773454 0.02149269] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 191 53.80s train loss is [0.3966 = 0.2489 + 0.1477] 
epoch 192 53.38s train loss is [0.3962 = 0.2485 + 0.1477] 
epoch 193 54.25s train loss is [0.3955 = 0.2476 + 0.1479] 
epoch 194 55.19s train loss is [0.3961 = 0.2483 + 0.1478] 
epoch 195 53.71s train loss is [0.3959 = 0.2479 + 0.1480] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  195  | 0.12385988235473633 | [0.00645697 0.00622517] | [0.03228477 0.06225166] | [0.0201878  0.02976292] | [0.03228477 0.06225166] | [0.01624448 0.02013008] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
epoch 196 53.65s train loss is [0.3965 = 0.2486 + 0.1479] 
epoch 197 49.90s train loss is [0.3967 = 0.2488 + 0.1479] 
epoch 198 44.19s train loss is [0.3962 = 0.2484 + 0.1478] 
epoch 199 44.39s train loss is [0.3963 = 0.2485 + 0.1478] 
epoch 200 44.26s train loss is [0.3965 = 0.2487 + 0.1479] 
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
| epoch |         time        |        precision        |          recall         |           ndcg          |        hit_ratio        |           MAP           |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
|  200  | 0.10723519325256348 | [0.007053   0.00639073] | [0.0352649  0.06390729] | [0.02108135 0.03029907] | [0.0352649  0.06390729] | [0.01646523 0.02024382] |
+-------+---------------------+-------------------------+-------------------------+-------------------------+-------------------------+-------------------------+
 
